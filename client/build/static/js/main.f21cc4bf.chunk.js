(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{165:function(e,t,a){},254:function(e,t,a){e.exports=a(466)},259:function(e,t,a){},260:function(e,t,a){},454:function(e,t){},466:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(34),i=a.n(l),s=a(59),o=(a(259),a(19)),c=a(20),u=a(23),m=a(21),d=a(22),h=(a(260),a(62)),p=a(104),g=a(473),y=a(220),f=a(31),E=a(35),v=a(74),b=a(17),w=a(28),j=a.n(w),k=a(244),S=a(480),O=(a(165),a(105)),C=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(v.a)({},e,t.target.value))}},a.handleMenuClick=function(e,t){var n=t.name;a.setState({activeMenu:n})},a.hideFixedMenu=function(){return a.setState({fixed:!1})},a.showFixedMenu=function(){return a.setState({fixed:!0})},a.state={user:a.props.user,fixed:!1,activeMenu:a.props.location.pathname},a.searchPlaylists=a.searchPlaylists.bind(Object(b.a)(a)),a.handleMenuClick=a.handleMenuClick.bind(Object(b.a)(a)),a.handleChange=a.handleChange.bind(Object(b.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"searchPlaylists",value:function(){var e=this;j.a.get("api/user/playlists?user=".concat(this.state.user)).then(function(t){e.props.sendDataToParent(t.data)})}},{key:"render",value:function(){var e=this.props.location.pathname,t=this.state.activeMenu;switch(e){case"/":return r.a.createElement(k.a,{inverted:!0,size:"large"},r.a.createElement(g.a,{fluid:!0},r.a.createElement(k.a.Item,{name:"home",active:"/home"===t,href:"/"}),r.a.createElement(k.a.Item,{name:"youtube",active:"/youtube"===t,href:"/youtube"}),r.a.createElement(k.a.Menu,{position:"right"},r.a.createElement(k.a.Item,{name:"login",active:"/login"===t,href:"/login"}),r.a.createElement(k.a.Item,{name:"signup",active:"/signup"===t,href:"/signup"}))));case"/login":case"/signup":return r.a.createElement(k.a,{inverted:!0,size:"large"},r.a.createElement(g.a,{fluid:!0},r.a.createElement(k.a.Item,{name:"home",active:"/home"===t,href:"/"}),r.a.createElement(k.a.Menu,{position:"right"},r.a.createElement(k.a.Item,{name:"login",active:"/login"===t,href:"/login"}),r.a.createElement(k.a.Item,{name:"signup",active:"/signup"===t,href:"/signup"}))));case"/profile":return r.a.createElement(k.a,{inverted:!0,size:"large",style:{borderRadius:"0px"}},r.a.createElement(g.a,{fluid:!0},r.a.createElement(k.a.Item,{name:"home",active:"/home"===t,href:"/"}),r.a.createElement(k.a.Item,{name:"youtube",active:"/youtube"===t,href:"/youtube"}),r.a.createElement(k.a.Menu,{position:"right"},r.a.createElement("div",{className:"ui action input",style:{marginTop:"auto",marginBottom:"auto",paddingRight:"10px"}},r.a.createElement("input",{type:"text",placeholder:"Search a user",onChange:this.handleChange("user")}),r.a.createElement(S.a,{className:"inverted green right attached",type:"button",onClick:this.searchPlaylists,onMouseDown:function(e){return e.preventDefault()}},"Search")))));case"/youtube":return r.a.createElement(k.a,{inverted:!0,size:"large"},r.a.createElement(g.a,{fluid:!0},r.a.createElement(k.a.Item,{name:"home",active:"/home"===t,href:"/"}),r.a.createElement(k.a.Item,{name:"youtube",active:"/youtube"===t,href:"/youtube"})))}}}]),t}(n.Component),x=a(151),P=a(474),I=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(y.a,{centered:!0,columns:"equal",style:{paddingTop:"30px"}},r.a.createElement(y.a.Row,null,r.a.createElement(y.a.Column,{width:5},r.a.createElement(x.a,{style:{textAlign:"left",height:"100%"}},r.a.createElement("h4",null,"Enjoy music in sync with your friends or strangers."),r.a.createElement(P.a,null),r.a.createElement("b",null,"Paghunie"," features"),r.a.createElement("ul",null,r.a.createElement("li",null,"Synced video player"),r.a.createElement("li",null,"Spotify playlist syncing"),r.a.createElement("li",null,"Queue system for songs"),r.a.createElement("li",null,"Realtime search")))),r.a.createElement(y.a.Column,{width:5},r.a.createElement(x.a,{style:{textAlign:"left",height:"100%"}},r.a.createElement("h4",null,"How to use Paghunie"),r.a.createElement(P.a,null),r.a.createElement("ol",null,r.a.createElement("li",null,"Join a ",r.a.createElement("a",{href:"/youtube"},"room")),r.a.createElement("li",null,"Search for your favorite music and add them to the queue"),r.a.createElement(P.a,null),r.a.createElement("li",null,"Optionally create an account to sync your spotify playlists"),r.a.createElement("li",null,"Select a song from the playlists tab to add them to the queue"))))))}}]),t}(n.Component),T=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){document.body.style.background="#202124"}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(p.Helmet,null,r.a.createElement("title",null,"Paghunie Music Site"),r.a.createElement("meta",{name:"description",content:"Welcome to Paghunie music site where you can listen to music in realtime with friends."})),r.a.createElement(C,{location:this.props.location}),r.a.createElement(g.a,{fluid:!0,textAlign:"center",style:{minHeight:700,paddingTop:"0px"}},r.a.createElement(g.a,{text:!0,style:{paddingTop:"80px"}},r.a.createElement("h1",{style:{color:"white"}},r.a.createElement(f.a,{icon:E.b})," Paghunie Music Site"),r.a.createElement("h3",{style:{color:"white"}},"Listen to music with friends"),r.a.createElement("h5",{style:{color:"white"}},"Site features realtime search and queue system for videos")),r.a.createElement(I,null),r.a.createElement("footer",{style:{position:"absolute",bottom:"0",width:"100%",height:"5rem",color:"white"}},r.a.createElement(y.a,{centered:!0,divided:!0,inverted:!0,columns:"equal",style:{height:"100%"}},r.a.createElement(y.a.Column,{width:4},r.a.createElement("h5",null,"Paghunie is a music site where you can enjoy music with friends or strangers. The site includes a realtime search and queue system for videos.")),r.a.createElement(y.a.Column,{width:4},r.a.createElement("h5",null,"Created with MySQL, Express, React, and Nodejs"))))))}}]),t}(n.Component),L=a(476),A=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(v.a)({},e,t.target.value))}},a.state={username:"",email:"",password:"",messageFromServer:"",showError:!1,registerError:!1,emailError:!1,usernameError:!1},a.handleChange=a.handleChange.bind(Object(b.a)(a)),a.registerUser=a.registerUser.bind(Object(b.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"registerUser",value:function(e){var t=this;e.preventDefault(),j.a.post("signup",{username:this.state.username,email:this.state.email,password:this.state.password}).then(function(e){console.log("response",e),"email is already taken"===e.data?t.setState({showError:!0,emailError:!0,usernameError:!1,registerError:!1}):"username is already taken"===e.data?t.setState({showError:!0,emailError:!1,usernameError:!0,registerError:!1}):"email and password required"===e.data||"Missing credentials"===e.data?t.setState({showError:!0,emailError:!1,usernameError:!1,registerError:!0}):t.setState({messageFromServer:e.data.message,showError:!1,emailError:!1,usernameError:!1,registerError:!1})}).catch(function(e){return console.log(e.data)})}},{key:"render",value:function(){var e=this.state,t=e.messageFromServer,a=e.showError,n=e.registerError,l=e.emailError,i=e.usernameError;return""===t?r.a.createElement("div",null,r.a.createElement(C,{location:this.props.location}),r.a.createElement(g.a,{className:"justify-content-center",style:{paddingTop:"30px",textAlign:"left"}},r.a.createElement("h1",null,r.a.createElement(f.a,{icon:E.c})," Signup"),r.a.createElement(L.a,{onSubmit:this.registerUser},r.a.createElement(L.a.Field,null,r.a.createElement("input",{type:"email",placeholder:"Enter email",onChange:this.handleChange("email")})),r.a.createElement(L.a.Field,null,r.a.createElement("input",{type:"text",placeholder:"Enter username",onChange:this.handleChange("username")})),r.a.createElement(L.a.Field,null,r.a.createElement("input",{type:"password",placeholder:"Password",onChange:this.handleChange("password")})),r.a.createElement(S.a,{color:"yellow",type:"submit"},"Submit")),!0===a&&!0===n&&r.a.createElement("div",null,r.a.createElement("p",null,"Email, username, and password are required fields.")),!0===a&&!0===l&&r.a.createElement("div",null,r.a.createElement("p",null,"That email is already taken. Please choose another for login.")),!0===a&&!0===i&&r.a.createElement("div",null,r.a.createElement("p",null,"That username is already taken. Please choose another for login.")))):"user created"===t?r.a.createElement("div",null,r.a.createElement("h3",null,"User successfully registered!"),r.a.createElement(S.a,{style:{margin:"1em"}},r.a.createElement(s.b,{style:{textDecoration:"none",color:"white"},to:"/login"},"Login"))):void 0}}]),t}(n.Component),M=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){a.setState(Object(v.a)({},e,t.target.value))}},a.state={username:"",password:"",showError:!1,loggedIn:!1},a.loginUser=a.loginUser.bind(Object(b.a)(a)),a.handleChange=a.handleChange.bind(Object(b.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"loginUser",value:function(e){var t=this;e.preventDefault(),j.a.post("login",{username:this.state.username,password:this.state.password}).then(function(e){"bad username"===e.data||"passwords do not match"===e.data?t.setState({showError:!0}):(localStorage.setItem("jwtToken",e.data.token),t.setState({loggedIn:!0,showError:!1}))}).catch(function(e){console.log(e.data)})}},{key:"render",value:function(){var e=this.state,t=e.showError;return e.loggedIn?r.a.createElement(h.a,{to:"/profile"}):r.a.createElement("div",null,r.a.createElement(C,{location:this.props.location}),r.a.createElement(g.a,{style:{paddingTop:"30px",textAlign:"left"}},r.a.createElement("h1",null,r.a.createElement(f.a,{icon:E.c})," Login"),r.a.createElement(L.a,{onSubmit:this.loginUser},r.a.createElement(L.a.Field,null,r.a.createElement("label",{style:{color:"white"}},"Username"),r.a.createElement("input",{type:"text",placeholder:"Enter username",onChange:this.handleChange("username")})),r.a.createElement(L.a.Field,null,r.a.createElement("label",{style:{color:"white"}},"Password"),r.a.createElement("input",{type:"password",placeholder:"Password",onChange:this.handleChange("password")})),r.a.createElement(S.a,{color:"yellow",type:"submit"},"Submit")),t&&r.a.createElement("p",null,"Incorrect email or password.")))}}]),t}(n.Component),N=a(36),q=a.n(N),D=a(51),_=a(221),R=a(76),F=a(478),H=a(479),z=a(52),U=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleClick=function(e,t){var n=t.index,r=a.state.activeIndex===n?-1:n;a.setState({activeIndex:r})},a.state={activeIndex:""},a.handleClick=a.handleClick.bind(Object(b.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.playlists;return t.length>0?r.a.createElement(F.a,{fluid:!0},r.a.createElement(F.a.Content,null,r.a.createElement(F.a.Header,null,r.a.createElement(f.a,{icon:E.b})," Playlists")),r.a.createElement(F.a.Content,null,r.a.createElement(H.a,{fluid:!0,styled:!0},t.map(function(t,a){return r.a.createElement("div",{key:t[0].playlist_name+"List"},r.a.createElement(H.a.Title,{active:e.state.activeIndex===a,index:a,onClick:e.handleClick},r.a.createElement(z.a,{name:"dropdown"}),t[0].playlist_name," (",t.length," songs)"),r.a.createElement(H.a.Content,{active:e.state.activeIndex===a},r.a.createElement("ul",null,t.map(function(e,a){return r.a.createElement("li",{key:t[0].playlist_name+a},e.song_name," - ",e.artist_name)}))))})))):r.a.createElement(F.a,{fluid:!0},r.a.createElement(F.a.Content,null,r.a.createElement(F.a.Header,null,r.a.createElement(f.a,{icon:E.b})," Playlists")),r.a.createElement(F.a.Content,null))}}]),t}(n.Component),Q=a(477),W=a(475),J=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleShow=function(){return a.setState({active:!0})},a.handleHide=function(){return a.setState({active:!1})},a.state={connected:a.props.spotifyAuth,playlists:a.props.playlists,isLoading:!1,active:!1,progress:0},a.connectSpotify=a.connectSpotify.bind(Object(b.a)(a)),a.updatePlaylists=a.updatePlaylists.bind(Object(b.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"connectSpotify",value:function(){var e=Object(D.a)(q.a.mark(function e(){var t,a,n,r,l=this;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({isLoading:!0}),t=localStorage.getItem("jwtToken"),e.next=4,j.a.get("api/spotify/authorize",{headers:{Authorization:"JWT ".concat(t)}}).then(function(e){return e.data.link});case 4:a=e.sent,n=window.open(a),r=setInterval(function(){n.closed&&(clearInterval(r),j.a.get("api/me",{headers:{Authorization:"JWT ".concat(t)}}).then(function(e){l.setState({connected:e.data.spotifyAuth,isLoading:!1})}))},1500);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"updatePlaylists",value:function(){var e=Object(D.a)(q.a.mark(function e(){var t,a=this;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("jwtToken"),e.next=3,j.a.get("api/spotify/sync",{headers:{Authorization:"JWT ".concat(t)}}).then(function(e){a.setState({playlists:e.data})});case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"syncPlaylist",value:function(){var e=Object(D.a)(q.a.mark(function e(t){var a;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=localStorage.getItem("jwtToken"),e.next=3,j.a.post("api/spotify/sync/playlist",{spotifyPlaylistName:t},{headers:{Authorization:"JWT ".concat(a)}});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.connected?r.a.createElement(F.a,{fluid:!0},r.a.createElement(F.a.Content,null,r.a.createElement(F.a.Header,null,r.a.createElement(f.a,{icon:O.a})," Spotify")),r.a.createElement(F.a.Content,null,r.a.createElement(S.a,{className:"green",loading:this.state.isLoading,onClick:this.updatePlaylists},"Update Playlists")),r.a.createElement(F.a.Content,null,r.a.createElement(Q.a,null,this.state.playlists.length>0&&this.state.playlists.map(function(t,a){return r.a.createElement(Q.a.Item,{key:t.name+a},r.a.createElement(S.a,{onClick:function(){return e.syncPlaylist(t.name)}},"Sync ",t.name," (",t.total||t.number_of_songs," ","songs)"),r.a.createElement(W.a,{percent:0,indicating:!0}))})))):r.a.createElement(F.a,{fluid:!0},r.a.createElement(F.a.Content,null,r.a.createElement(F.a.Header,null,r.a.createElement(f.a,{icon:O.a})," Spotify")),r.a.createElement(F.a.Content,null,r.a.createElement(S.a,{className:"green",loading:this.state.isLoading,onClick:this.connectSpotify},"Connect Spotify")))}}]),t}(n.Component),B=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(F.a,{fluid:!0},r.a.createElement(F.a.Content,null,r.a.createElement(F.a.Header,null,r.a.createElement(f.a,{icon:E.d})," Account Information")),r.a.createElement(F.a.Content,{style:{wordWrap:"break-word"}},r.a.createElement("strong",null,"id"),": ",this.props.user.id,r.a.createElement("br",null),r.a.createElement("strong",null,"username"),": ",this.props.user.username,r.a.createElement("br",null),r.a.createElement("strong",null,"email"),": ",this.props.user.email,r.a.createElement("br",null),r.a.createElement("strong",null,"password"),": ",this.props.user.password,r.a.createElement("br",null)))}}]),t}(n.Component),V=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).logout=a.logout.bind(Object(b.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"logout",value:function(e){this.setState({auth:!1}),localStorage.removeItem("jwtToken")}},{key:"render",value:function(){var e=this.props.state,t=e.id,a=e.username,n=e.email,l=e.password,i=e.auth,s=e.spotifyAuth,o=e.error;return e.isLoading?r.a.createElement("div",null,"Loading..."):!o&&i?r.a.createElement(g.a,{fluid:!0,style:{paddingTop:"20px",textAlign:"left",maxWidth:"1400px"}},r.a.createElement(y.a,{centered:!0,style:{paddingBottom:"1rem"}},r.a.createElement(_.a,{style:{paddingBottom:"0.5rem"}},r.a.createElement("h1",null,r.a.createElement(f.a,{icon:E.a})," Profile Page")),r.a.createElement(S.a,{className:"inverted red small",onClick:this.logout,href:"/"},"Logout")),r.a.createElement(P.a,null),r.a.createElement(y.a,{centered:!0,columns:"equal"},r.a.createElement(R.a,{width:5,className:"ml-auto"},r.a.createElement(_.a,{style:{paddingBottom:"20px"}},r.a.createElement(B,{user:{id:t,username:a,email:n,password:l}})),r.a.createElement(_.a,null,r.a.createElement(U,{playlists:this.props.state.searchPlaylists}))),r.a.createElement(R.a,{width:5,className:"mr-auto"},r.a.createElement(J,{spotifyAuth:s,playlists:this.props.state.syncPlaylists})))):i?void 0:r.a.createElement(h.a,{to:"/"})}}]),t}(n.Component),Y=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleSearch=function(e){a.setState({searchPlaylists:e})},a.state={id:"",username:"",email:"",password:"",syncPlaylists:[],searchPlaylists:[],auth:!1,spotifyAuth:!1,isLoading:!0,error:!1},a.handleSearch=a.handleSearch.bind(Object(b.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(D.a)(q.a.mark(function e(){var t,a=this;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return null===(t=localStorage.getItem("jwtToken"))&&this.setState({isLoading:!1,error:!0}),e.next=4,j.a.get("api/me",{headers:{Authorization:"JWT ".concat(t)}}).then(function(e){a.setState({id:e.data.id,username:e.data.username,email:e.data.email,password:e.data.password,syncPlaylists:e.data.syncPlaylists,auth:e.data.auth,spotifyAuth:e.data.spotifyAuth,isLoading:!1,error:!1})});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(C,{location:this.props.location,user:this.state.username,sendDataToParent:this.handleSearch}),r.a.createElement(V,{state:this.state}))}}]),t}(n.Component),K=a(235),X=a(238),G=a.n(X),Z=a(482),$=a(150),ee=(a(464),a(465),Object($.b)($.a));function te(e){return e.videoPlaylist.length>0?r.a.createElement("div",null,e.videoPlaylist.map(function(t,a){return r.a.createElement("div",{className:"ui small image",style:{textAlign:"center",marginTop:"5px",paddingLeft:"5px",paddingRight:"5px",whiteSpace:"normal",verticalAlign:"top"}},r.a.createElement(S.a,{as:"a",className:"ui red right corner label",style:{overflow:"hidden",marginLeft:"5px",marginRight:"5px"},onClick:function(){return e.removeFromQueue(a)}},r.a.createElement("i",{className:"times circle icon"})),r.a.createElement("img",{className:"ui small rounded centered image",src:t.thumbnail}),r.a.createElement("p",{style:{color:"white"}},t.title.substring(0,t.title.length>35?35:t.title.length)))})):r.a.createElement("div",null)}function ae(e,t){var a=[];return e.map(function(e,n){a[n]={},a[n].menuItem=e[0].playlist_name,a[n].render=function(){return r.a.createElement(Z.a.Pane,{inverted:!0,style:{height:"615px",overflowY:"scroll"}},r.a.createElement(k.a,{vertical:!0,inverted:!0,size:"tiny",style:{width:"100%"}},e.map(function(a,n){return r.a.createElement(k.a.Item,{key:e[0].playlist_name+n,onClick:function(){t("".concat(a.song_name," - ").concat(a.artist_name))}},a.song_name," - ",a.artist_name)})))}}),a}var ne=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleInputChange=function(e){a.setState({searchString:e})},a.handleChange=function(e){e.length>0&&a.setState({searchString:e[0].song_name+" - "+e[0].artist_name})},a.handleOnKeyDown=function(e){13===e.keyCode&&a.searchSong(e)},a.state={searchString:"",videoId:"",username:"",userPlaylists:[],videoPlaylist:[],isLoading:!0,player:null,options:[],socket:void 0,width:0,height:0,host:!1},a.onStateChange=a.onStateChange.bind(Object(b.a)(a)),a.onReady=a.onReady.bind(Object(b.a)(a)),a.searchSong=a.searchSong.bind(Object(b.a)(a)),a.nextSong=a.nextSong.bind(Object(b.a)(a)),a.handleChange=a.handleChange.bind(Object(b.a)(a)),a.handleInputChange=a.handleInputChange.bind(Object(b.a)(a)),a.removeFromQueue=a.removeFromQueue.bind(Object(b.a)(a)),a.clearQueue=a.clearQueue.bind(Object(b.a)(a)),a.syncHost=a.syncHost.bind(Object(b.a)(a)),a.handlePlaylistClick=a.handlePlaylistClick.bind(Object(b.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(D.a)(q.a.mark(function e(){var t,a,n=this;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.background="#202124",t=localStorage.getItem("jwtToken"),e.next=4,j.a.get("api/me",{headers:{Authorization:"JWT ".concat(t)}}).then(function(e){null!==e&&n.setState({username:e.data.username})});case 4:if(void 0===this.state.username){e.next=7;break}return e.next=7,j.a.get("api/user/playlists?user=".concat(this.state.username)).then(function(e){null!==e&&n.setState({userPlaylists:e.data})}).then(function(){return n.sortSongs()});case 7:a=G()(),this.setState({socket:a}),a.emit("new room",function(e){n.setState({videoId:e.videoId,host:e.host,isLoading:!1})}),a.on("get queue",function(e){n.setState({videoPlaylist:e.queue,videoId:null===e.videoId?n.state.videoId:e.videoId,searchString:""})}),a.on("restart video",function(){n.state.player.seekTo(0,!0)}),a.on("sync client video",function(e){var t=n.state.player.getCurrentTime();Math.abs(t-e.currentTime)>.2&&(n.state.player.seekTo(e.currentTime),n.state.player.playVideo())}),a.on("sync client player state",function(e){var t=n.state.player.getPlayerState();1===e.playerState?-1!==t&&2!==t||n.state.player.playVideo():n.state.player.pauseVideo()}),a.on("sync host",function(e){n.state.socket.emit("sync video",{currentTime:n.state.player.getCurrentTime(),requestingSocket:void 0!==e.requestingSocket?e.requestingSocket:void 0})}),a.on("pinging",function(){a.emit("ponging")});case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"playerSeek",value:function(e){this.state.player.seekTo(e)}},{key:"onReady",value:function(e){this.setState({player:e.target}),this.state.player.setVolume(25)}},{key:"onStateChange",value:function(e){switch(e.data){case 0:0===this.state.videoPlaylist.length?this.state.socket.emit("restart video"):this.state.socket.emit("next video");break;case 1:case 2:this.state.socket.emit("sync player state",{playerState:e.data});break;case 3:this.state.socket.emit("sync video",{currentTime:this.state.player.getCurrentTime()})}}},{key:"sortSongs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"artist asc";function t(e,t){return e.artist_name>t.artist_name?1:-1}function a(e,t){return e.song_name.toUpperCase()<t.song_name.toUpperCase()?1:-1}if(this.state.userPlaylists.length>0)switch(e){case"artist asc":this.setState(function(e){return e.userPlaylists.forEach(function(e,n){e.sort(a),e.sort(t)}),{userPlaylists:e.userPlaylists}})}}},{key:"handlePlaylistClick",value:function(e){this.state.socket.emit("queue video",{search:e})}},{key:"searchSong",value:function(e){e.preventDefault(),this.typeahead.getInstance().clear(),this.state.socket.emit("queue video",{search:this.state.searchString})}},{key:"nextSong",value:function(){this.onStateChange({data:0})}},{key:"clearQueue",value:function(){this.state.socket.emit("clear queue")}},{key:"syncHost",value:function(){this.state.socket.emit("sync host")}},{key:"removeFromQueue",value:function(e){this.state.socket.emit("update queue",{action:"remove",index:e}),this.setState(function(t){return t.videoPlaylist.splice(e,1),{videoPlaylist:t.videoPlaylist}})}},{key:"render",value:function(){var e=this;return r.a.createElement(g.a,{fluid:!0},r.a.createElement(y.a,{centered:!0,columns:"equal",stackable:!0},r.a.createElement(_.a,{centered:!0,columns:2,style:{paddingTop:"0px",paddingBottom:"0px"}},r.a.createElement(R.a,{width:4},r.a.createElement("div",{className:"input-group"},r.a.createElement(ee,{ref:function(t){return e.typeahead=t},placeholder:"Search for a song",align:"left",autoFocus:!0,onInputChange:this.handleInputChange,onChange:this.handleChange,autoComplete:"off",id:"realtimeSearch",useCache:!0,isLoading:this.state.isLoading,onSearch:function(t){e.setState({isLoading:!0}),j.a.get("api/search?key=".concat(t)).then(function(t){return e.setState({isLoading:!1,options:t.data})})},labelKey:function(e){return"".concat(e.song_name," - ").concat(e.artist_name)},options:this.state.options}),r.a.createElement("span",{className:"input-group-btn"},r.a.createElement(S.a,{className:"inverted green small right attached",type:"submit",onClick:this.searchSong,onMouseDown:function(e){return e.preventDefault()}},"Add to queue"))))),r.a.createElement(_.a,{columns:3,style:{paddingTop:"0px",paddingBottom:"0px",height:"720px"}}," ",r.a.createElement(R.a,{width:3,style:{paddingRight:"0px",paddingLeft:"0px",height:"100%",overflowY:"scroll"}}),r.a.createElement(R.a,{width:10,style:{height:"100%",paddingLeft:"5px",paddingRight:"5px"}},r.a.createElement(K.a,{containerClassName:"youtubePlayer justify-content-center",id:"player",videoId:this.state.videoId,opts:{playerVars:{autoplay:1}},onReady:this.onReady,onStateChange:this.onStateChange}),r.a.createElement(_.a,{style:{height:"36px"}},r.a.createElement(S.a,{className:"inverted green small",floated:"left",onClick:this.syncHost,onMouseDown:function(e){return e.preventDefault()}},"Sync Host"),r.a.createElement(S.a,{className:"inverted green small",floated:"right",onClick:function(){e.nextSong({data:0})},onMouseDown:function(e){return e.preventDefault()}},"Next Song"),r.a.createElement(S.a,{className:"inverted green small",floated:"right",onClick:this.clearQueue,onMouseDown:function(e){return e.preventDefault()}},"Clear queue")),r.a.createElement(_.a,{style:{whiteSpace:"nowrap"}},r.a.createElement(F.a,{style:{backgroundColor:"#202124",borderColor:"#202124",visibility:0===this.state.videoPlaylist.length?"hidden":"visible",display:"flex",minWidth:"100%",overflowX:"scroll"}},r.a.createElement(te,{videoPlaylist:this.state.videoPlaylist,removeFromQueue:this.removeFromQueue})))),r.a.createElement(R.a,{width:3,style:{paddingRight:"0px",paddingLeft:"0px",height:"100%"}},r.a.createElement(Z.a,{menu:{inverted:!0,attached:!0,tabular:!1},style:{height:"100%",paddingRight:"20px"},panes:[{menuItem:"Chat",render:function(){return r.a.createElement(Z.a.Pane,{inverted:!0,style:{height:"680px"}},"Placeholder")}},{menuItem:"Playlists",render:function(){return e.state.userPlaylists.length>0?r.a.createElement(Z.a,{size:"small",menu:{inverted:!0,attached:!1,secondary:!0},style:{height:"100%"},panes:ae(e.state.userPlaylists,e.handlePlaylistClick)}):r.a.createElement(Z.a.Pane,{inverted:!0,style:{height:"680px"}},"Login or Signup and sync your Spotify playlists to view your playlists.")}}]}))),r.a.createElement(_.a,{centered:!0,columns:3,style:{paddingTop:"10px"}}," ",r.a.createElement(R.a,{width:10,style:{paddingRight:"0px",paddingLeft:"0px"}},r.a.createElement(y.a,{columns:2,className:"mt-0",style:{paddingTop:"0px"}},r.a.createElement(R.a,{width:14,style:{paddingRight:"0px",paddingTop:"0px"}}),r.a.createElement(R.a,{width:2,style:{paddingLeft:"0px",paddingTop:"0px"}}))))))}}]),t}(n.Component),re=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(p.Helmet,null,r.a.createElement("title",null,"Youtube Room"),r.a.createElement("meta",{name:"description",content:"Add songs to the queue and listen to music with friends."})),r.a.createElement(C,{location:this.props.location}),r.a.createElement(ne,null))}}]),t}(n.Component),le=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){window.opener.focus(),window.close()}},{key:"render",value:function(){return r.a.createElement("div",null)}}]),t}(n.Component),ie=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(h.d,null,r.a.createElement(h.b,{exact:!0,path:"/",component:T}),"}",r.a.createElement(h.b,{exact:!0,path:"/signup",component:A}),r.a.createElement(h.b,{exact:!0,path:"/login",component:M}),r.a.createElement(h.b,{exact:!0,path:"/profile",component:Y}),r.a.createElement(h.b,{exact:!0,path:"/youtube",component:re}),r.a.createElement(h.b,{exact:!0,path:"/api/after-auth",component:le})))}}]),t}(n.Component),se=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(ie,null))}}]),t}(n.Component);i.a.render(r.a.createElement(s.a,null,r.a.createElement(se,null)),document.getElementById("root"))}},[[254,1,2]]]);
//# sourceMappingURL=main.f21cc4bf.chunk.js.map